@{
    ViewData["Title"] = "Create User";
    var roles = ViewBag.Roles as List<TravelAgencyMVC.Models.Role>;
}

<h2>Create User</h2>

@if (TempData["Error"] != null)
{
    <div class="alert alert-danger">@TempData["Error"]</div>
}

<form method="post" action="/Admin/CreateUser" class="mt-3">

    <div class="mb-3">
        <label class="form-label">Full Name</label>
        <input class="form-control" name="fullName" required />
    </div>

    <div class="mb-3">
        <label class="form-label">Email</label>
        <input class="form-control" type="email" name="email" required />
    </div>

    <div class="mb-3">
        <label class="form-label">Password</label>
        <input class="form-control" type="text" name="password" required />
    </div>

    <div class="mb-3">
        <label class="form-label">Role</label>

        <select class="form-select" name="roleId" required>
            <option value="">-- Select Role --</option>

            @if (roles != null && roles.Any())
            {
                foreach (var r in roles)
                {
                    var rn = (r.RoleName ?? "").Trim();

                    // נציג רק Admin/User אבל עם Trim כדי שלא ייפול על רווחים
                    if (rn == "Admin" || rn == "User")
                    {
                        <option value="@r.RoleId">@rn</option>
                    }
                }
            }
        </select>

        <div class="text-muted small mt-1">
            Roles loaded: @(roles?.Count ?? 0)
        </div>

        @if (roles == null)
        {
            <div class="text-danger small mt-1">
                ViewBag.Roles is NULL (Controller didn’t load roles).
            </div>
        }
    </div>

    <button class="btn btn-success">Create</button>
    <a class="btn btn-secondary" href="/Admin/Users">Back</a>
</form>
